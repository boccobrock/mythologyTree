<!DOCTYPE html>
<html>
    <head>
        <title>Greek Pantheon Map</title>
        <meta charset="utf-8">
        <style>
            .node {
                stroke: #CCC;
                stroke-width: .5px;
            }

            .link {
                stroke-width: 3.5px;
                stroke-opacity: .4;
            }

            .legend {
            }

            .legend-type {
                display: inline;
                margin-left: 20px;
            }

            .legend-icon {
                display: inline-block;
                width: 12px;
                height: 12px;
                margin-right: 4px;
                background: #0CC;
            }

            .active {
                stroke-opacity: 1;
            }

            text {
                font: 10px sans-serif;
                pointer-events: none;
            }

        </style>
        <script src="http://d3js.org/d3.v3.min.js"></script>
    </head>
    <body>
        <h2>Greek Pantheon Map</h2>
        <h3>Legend</h3>
        <div class="legend">Connections: 
            <div class="legend-type"><div class="legend-icon"></div>Parent/Child</div>
            <div class="legend-type"><div class="legend-icon"></div>Wife/Husband</div>
            <div class="legend-type"><div class="legend-icon"></div>Lover</div>
        </div>
        <div class="legend">Circles: 
            <div class="legend-type"><div class="legend-icon"></div>Primordial</div>
            <div class="legend-type"><div class="legend-icon"></div>Titan</div>
            <div class="legend-type"><div class="legend-icon"></div>Olympian</div>
            <div class="legend-type"><div class="legend-icon"></div>Muse</div>
            <div class="legend-type"><div class="legend-icon"></div>Fates</div>
            <div class="legend-type"><div class="legend-icon"></div>Oceanid</div>
            <div class="legend-type"><div class="legend-icon"></div>Minor God</div>
            <div class="legend-type"><div class="legend-icon"></div>Semi-Divine</div>
            <div class="legend-type"><div class="legend-icon"></div>Mortal</div>
        </div>
        <script>
            var graphData = '{\
                "nodes":[\
                {"name":"Zeus","group":5},\
                {"name":"Mnemosyne","group":4},\
                {"name":"Calliope","group":6},\
                {"name":"Clio","group":6},\
                {"name":"Erato","group":6},\
                {"name":"Euterpe","group":6},\
                {"name":"Melpomene","group":6},\
                {"name":"Polyhymnia","group":6},\
                {"name":"Terpsichore","group":6},\
                {"name":"Thalia","group":6},\
                {"name":"Urania","group":6},\
                {"name":"Themis","group":4},\
                {"name":"Atropos","group":7},\
                {"name":"Clotho","group":7},\
                {"name":"Lachesis","group":7},\
                {"name":"Demeter","group":5},\
                {"name":"Persephone","group":5},\
                {"name":"Zagreus","group":9},\
                {"name":"Dione","group":8},\
                {"name":"Aphrodite","group":5},\
                {"name":"Hera","group":5},\
                {"name":"Ares","group":5},\
                {"name":"Hephaestus","group":5},\
                {"name":"Leto","group":4},\
                {"name":"Apollo","group":5},\
                {"name":"Artemis","group":5}\
                ],\
                "links":[\
                {"source":0,"target":1,"value":2},\
                {"source":0,"target":2,"value":0},\
                {"source":1,"target":2,"value":0},\
                {"source":0,"target":3,"value":0},\
                {"source":1,"target":3,"value":0},\
                {"source":0,"target":4,"value":0},\
                {"source":1,"target":4,"value":0},\
                {"source":0,"target":5,"value":0},\
                {"source":1,"target":5,"value":0},\
                {"source":0,"target":6,"value":0},\
                {"source":1,"target":6,"value":0},\
                {"source":0,"target":7,"value":0},\
                {"source":1,"target":7,"value":0},\
                {"source":0,"target":8,"value":0},\
                {"source":1,"target":8,"value":0},\
                {"source":0,"target":9,"value":0},\
                {"source":1,"target":9,"value":0},\
                {"source":0,"target":10,"value":0},\
                {"source":1,"target":10,"value":0},\
                {"source":0,"target":11,"value":2},\
                {"source":0,"target":12,"value":0},\
                {"source":11,"target":12,"value":0},\
                {"source":0,"target":13,"value":0},\
                {"source":11,"target":13,"value":0},\
                {"source":0,"target":14,"value":0},\
                {"source":11,"target":14,"value":0},\
                {"source":0,"target":15,"value":2},\
                {"source":0,"target":16,"value":0},\
                {"source":15,"target":16,"value":0},\
                {"source":0,"target":17,"value":0},\
                {"source":15,"target":17,"value":0},\
                {"source":0,"target":18,"value":2},\
                {"source":0,"target":19,"value":0},\
                {"source":18,"target":19,"value":0},\
                {"source":0,"target":20,"value":1},\
                {"source":0,"target":21,"value":0},\
                {"source":20,"target":21,"value":0},\
                {"source":0,"target":22,"value":0},\
                {"source":20,"target":22,"value":0},\
                {"source":0,"target":23,"value":2},\
                {"source":0,"target":24,"value":0},\
                {"source":23,"target":24,"value":0},\
                {"source":0,"target":25,"value":0},\
                {"source":23,"target":25,"value":0}\
                ]\
            }';

            var width = window.innerWidth-100,
            height = window.innerHeight-100;

            var color = d3.scale.category20();

            d3.selectAll(".legend-icon").each(function(d, i){ d3.select(this).style("background", function(d) { return color(i); } ) });

            var force = d3.layout.force()
            .charge(-500)
            .linkDistance(function(d) {return (1+d.value)*100; })
            .linkStrength(0.2)
            .size([width, height]);

            var svg = d3.select("body").append("svg")
            .attr("width", width)
            .attr("height", height);

            graph = JSON.parse(graphData);

            force
            .nodes(graph.nodes)
            .links(graph.links)
            .start();

            var link = svg.selectAll(".link")
            .data(graph.links)
            .enter().append("line")
            .attr("class", "link")
            .style("stroke", function(d) { return color(d.value); });

            var node = svg.append("svg:g").selectAll(".node")
            .data(graph.nodes)
            .enter().append("circle")
            .attr("class", "node")
            .attr("r", 20)
            .style("fill", function(d) { return color(d.group); })
            .call(force.drag)
            .on("mouseover", nodemouseover)
            .on("mouseout", nodemouseout);

            var text = svg.append("svg:g").selectAll("g")
            .data(force.nodes())
            .enter().append("svg:g");

            text.append("svg:text")
            .attr("y", ".31em")
            .style("text-anchor", "middle")
            .text(function(d) { return d.name; });

            function nodemouseover(d) {
            svg.selectAll(".link").classed("active", function(p) { return p.source === d || p.target === d; });
            d3.select(this).classed("active", true);
            }

            function nodemouseout() {
            svg.selectAll(".active").classed("active", false);
            }

            node.append("title")
            .text(function(d) { return d.name; });

            force.on("tick", function() {
            link.attr("x1", function(d) { return d.source.x; })
            .attr("y1", function(d) { return d.source.y; })
            .attr("x2", function(d) { return d.target.x; })
            .attr("y2", function(d) { return d.target.y; });

            node.attr("transform", function(d) {
            return "translate(" + d.x + "," + d.y + ")";
            });

            text.attr("transform", function(d) {
            return "translate(" + d.x + "," + d.y + ")";
            });
            });
        </script>
    </body>
</html>
